SEGMENT_PORT EQU P0
SELECT_PORT EQU P2
LED7SEG DATA 30H

ORG 0000H
	JMP MAIN

ORG 0030H
	MAIN:
	MOV LED7SEG, #0

LOOP:
	MOV A, LED7SEG
	RL A
	RL A
	MOV SELECT_PORT, A

	MOV A, LED7SEG
	ANL A, #03H

	JZ DISPLAY_9_1
	CJNE A, #01H, CHECK_LED2
	MOV A, #0
	JMP SHOW_DIGIT
CHECK_LED2:
	CJNE A, #02H, CHECK_LED3
	MOV A, #9
	JMP SHOW_DIGIT
CHECK_LED3:
	MOV A, #1
	JMP SHOW_DIGIT

DISPLAY_9_1:
	MOV A, #9

SHOW_DIGIT:
	MOV DPTR, #DIGIT_PATTERNS
	MOVC A, @A+DPTR
	MOV SEGMENT_PORT, A

CONTINUE:
	CALL DELAY_2MS

	INC LED7SEG
	MOV A, LED7SEG
	ANL A, #03H
	MOV LED7SEG, A

	JMP LOOP

DELAY_2MS:
	MOV R2, #1000
D2_OUTER:
	MOV R1, #250
D2_INNER:
	DJNZ R1, D2_INNER
	DJNZ R2, D2_OUTER
	RET

DIGIT_PATTERNS:
	DB 03FH
	DB 006H
	DB 05BH
	DB 04FH
	DB 066H
	DB 06DH
	DB 07DH
	DB 007H
	DB 07FH
	DB 06FH

END